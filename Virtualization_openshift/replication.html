<!--
title: Replication
description: 
published: true
date: 2025-11-21T14:46:38.486Z
tags: 
editor: ckeditor
dateCreated: 2025-11-20T17:40:49.338Z
-->

<h1>Clone Virtual Machines</h1>
<ul>
  <li>To prevent the clones from having these same identifying settings, seal the original VM before using it to create clones.</li>
</ul>
<blockquote>
  <p>Sealing the VM is a process where you clear the machine-specific information.</p>
</blockquote>
<ul>
  <li>For Microsoft Windows systems, use the <code>sysprep.exe</code> command to initiate a System Out-of-Box-Experience (OOBE).</li>
  <li>For Red&nbsp;Hat Enterprise Linux systems, use the <code>virt-sysprep</code> command.<ul>
      <li>stop the VM before using the <code>virt-sysprep</code> command.</li>
      <li>run the command from &nbsp;a Linux system with access to the VM disk block devices.</li>
    </ul>
  </li>
  <li><code>virtctl guestfs</code> command to start a container that includes the <code>libguestfs-tools</code> package.<ul>
      <li>The <code>virt-sysprep</code> tool modifies the guest or disk image in place. The guest VM must be shut down.</li>
      <li>This package includes the <code>virt-sysprep</code> utility and other tools for accessing and modifying VM disk images.</li>
      <li>container also attaches the VM's persistent volume claim (PVC) as the <code>/​dev/​vda</code> block device. The <code>virtctl guestfs</code> command accepts only a single PVC that is attached to the interactive pod.</li>
    </ul>
  </li>
</ul>
<pre><code class="language-plaintext"> virtctl guestfs -n namespace disk</code></pre>
<h6>The <code>virt-sysprep</code> tool&nbsp;</h6>
<pre><code class="language-plaintext">virt-sysprep --list-operations</code></pre>
<p>&nbsp;</p>
<ul>
  <li>To execute operations on a specific disk image, add the disk with the <code>-a</code> option</li>
</ul>
<pre><code class="language-plaintext">virt-sysprep -a /dev/vda</code></pre>
<p>&nbsp;</p>
<ul>
  <li>Use the <code>virt-sysprep --enable</code> option to select only some operations.</li>
</ul>
<pre><code class="language-plaintext"> virt-sysprep -a /dev/vda --enable ca-certificates,user-account \
  --remove-user-accounts cloud-user</code></pre>
<h6>The <code>virt-edit</code> command</h6>
<ul>
  <li>enables editing any file in the image.</li>
</ul>
<h6>The <code>virt-customize</code> command&nbsp;</h6>
<ul>
  <li>enables admins to inject SSH keys or to run package manager commands to update an image.</li>
</ul>
<blockquote>
  <p>The first time that the VM boots after sealing, the operating system re-creates many of the items that the sealing tools stripped out.</p>
  <p>Thus, never start a VM that you sealed. If you accidentally start the VM, then you must repeat the process of sealing the image.</p>
</blockquote>
<h4>Clone Virtual Machines by Using the Command Line</h4>
<pre><code class="language-plaintext">virtctl create clone --source-name golden-vm \
  --target-name new-vm
apiVersion: clone.kubevirt.io/v1alpha1
kind: VirtualMachineClone
metadata:
  creationTimestamp: null
  name: clone-rglbs
spec:
  source:
    apiGroup: kubevirt.io
    kind: VirtualMachine
    name: golden-vm
  target:
    apiGroup: kubevirt.io
    kind: VirtualMachine
    name: new-vm
  template: {}
status: {}</code></pre>
<h3>Clone VM Disks by Using Data Volumes</h3>
<ul>
  <li>The Containerized Data Importer (CDI) provides a custom resource definition (CRD) for <code>datavolume</code> objects that orchestrate the import, clone, and upload operations that are associated with an underlying PVC.</li>
  <li>Each <code>virtualmachine</code> resource includes a <code>dataVolumeTemplates</code> section that is used to create a <code>datavolume</code> resource if the volume does not exist. When OpenShift Virtualization clones a VM, it creates a <code>datavolume</code> resource to clone the VM disks.</li>
  <li>If the back-end storage provides<mark class="marker-yellow"> a cloning feature</mark> and the Container Storage Interface (CSI) driver supports the feature, then OpenShift Virtualization uses that method.<ul>
      <li>Otherwise, if the back-end storage and its CSI driver <mark class="marker-yellow">support snapshots,</mark> then OpenShift Virtualization uses temporary snapshots for the cloning process.<ul>
          <li>If the back-end storage does not support snapshots, then OpenShift Virtualization starts <mark class="marker-yellow">Kubernetes pods</mark> to copy the content of the source volume to the destination volume</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>The <code>StorageProfile</code> resource that OpenShift Virtualization associates with each storage class uses the <code>cloneStrategy</code> parameter to specify the cloning method:<ul>
      <li><code><strong>csi-clone:</strong></code>The cloning process relies on the back-end storage cloning feature. This method is also called <i>CSI volume cloning</i>.</li>
      <li><code><strong>snapshot:</strong></code>The cloning process relies on the back-end storage snapshot feature. This method is also called <i>smart cloning</i>.</li>
      <li><code><strong>copy:</strong></code>The cloning process does not rely on back-end storage. OpenShift Virtualization starts Kubernetes pods for the copying. This method is also called <i>host-assisted cloning</i>.</li>
    </ul>
  </li>
</ul>
<blockquote>
  <p>For CSI and smart cloning, the source and target PVCs must have the same storage class and volume mode, and the source volume must not be in use.&nbsp;</p>
</blockquote>
<blockquote>
  <p>To clone disks across namespaces, a cluster role and corresponding role binding are necessary to provide permissions for all actions for the <code>datavolume</code> resource.</p>
</blockquote>
<ul>
  <li>to clone an individual disk, &nbsp;create a <code>datavolume</code> resource.</li>
</ul>
<pre><code class="language-plaintext">apiVersion: cdi.kubevirt.io/v1beta1
kind: DataVolume
metadata:
  name: documentroot-clone1
spec:
  storage:  1
    resources:
      requests:
        storage: 1Gi
    storageClassName: ocs-external-storagecluster-ceph-rbd-virtualization
  source:  2
    pvc:
      name: documentroot
      namespace: golden-vms</code></pre>
<p>&nbsp;</p>
<pre><code class="language-plaintext"> oc get datavolume</code></pre>
<h2>Predefined Virtual Machine Templates and Instance Types</h2>
<ul>
  <li>Red&nbsp;Hat OpenShift Virtualization provides a catalog of preconfigured templates to create a virtual machine and its resources.&nbsp;</li>
  <li>data volumes could be used to clone existing PVC, create new data volumes, or uploading the disk image.&nbsp;</li>
  <li>The cloning process creates a <code>datavolume</code> resource in the destination project to create and populate the PVC that is used as the VM's bootable disk.</li>
</ul>
<h4>Attributes of a Template</h4>
<ul>
  <li><strong>Disk Source: </strong>This field indicates the source of the image to create your VM, and includes the following options:<ul>
      <li><strong>Template default: </strong>Use the default template disk source.</li>
      <li><strong>PVC (clone PVC): </strong>Clone an existing PVC in the cluster to create a PVC.</li>
      <li><strong>Registry (creates PVC): </strong>Create a PVC by importing content from a container registry.</li>
      <li><strong>URL (creates PVC): </strong>Create a PVC by importing content from a URL with an HTTP or an S3 endpoint.</li>
      <li><strong>Upload (Upload a new file to a PVC): </strong>Create a PVC by uploading a new file to a PVC.</li>
      <li><strong>Blank: </strong>Create a blank PVC.</li>
    </ul>
  </li>
  <li><strong>CPU | Memory: </strong>This field indicates the size of your VM in terms of CPU and memory. Template names from Red&nbsp;Hat indicate the size of the provisioned VM with the following options:<ul>
      <li><strong>Tiny: </strong>Create a VM with 1 CPU and 1&nbsp;GiB memory. Recommended for testing VM creation.</li>
      <li><strong>Small: </strong>Create a VM with 1 CPU and 2&nbsp;GiB memory. This option is the default for any preconfigured template.</li>
      <li><strong>Medium: </strong>Create a VM with 1 CPU and 4&nbsp;GiB memory. Appropriate for code testing or to store basic application resources.</li>
      <li><strong>Large: </strong>Create a VM with 2 CPUs and 8&nbsp;GiB memory. Recommended for systems that require heavy resource consumption.</li>
    </ul>
  </li>
  <li><strong>Workload: </strong>This field indicates the workload type for your VM, and includes the following options:<ul>
      <li><strong>Desktop: </strong>A configuration for a desktop system that prioritizes VM density over VM performance. Red&nbsp;Hat recommends VMs with this configuration.</li>
      <li><strong>Server: </strong>The default option for any preconfigured template, and compatible with various server workloads. This option balances performance and prioritizes VM density over VM performance.</li>
      <li><strong>High performance: </strong>Optimized for high-performance or high-consumption workloads. This option prioritizes VM performance over VM density.</li>
    </ul>
  </li>
  <li><strong>Disks: </strong>A preconfigured Linux-based template has two partitions by default, <code>cloud-init</code> and <code>root disk</code>. However, you can configure additional disks. Each field has several available options for customizing your template:<ul>
      <li><strong>Source: </strong>You can create or import a disk from an existing or blank PVC, from an external source such as a container registry or URL, or by using a container in a registry that is accessible from the cluster.</li>
      <li><strong>Type: </strong>You can customize the storage type, such as a disk or CD-ROM, according to the needs of your VM.</li>
      <li><strong>Interface: </strong>You can select the communication interface of your disk based on compatibility standards and the intended performance of your VM. The available options are <i>virtIO</i>, <i>SATA</i>, or <i>SCSI</i>.</li>
      <li><strong>StorageClass: </strong>Select the storage class for the disk. The storage profile sets the optimized access mode, and the volume mode for the storage class.</li>
      <li><strong>Access Mode: </strong>You can customize the disk's access mode and override the default storage profile settings. The available access modes are Single user (<code>RWO</code>), Shared access (<code>RWX</code>), or Read only (<code>ROX</code>).</li>
      <li><strong>Volume Mode: </strong>You can choose between <code>Filesystem</code> and <code>Block</code> storage volume modes for your VM, depending on the selected storage class.</li>
    </ul>
  </li>
  <li><strong>Network interfaces: </strong>Red&nbsp;Hat provides templates with a default network interface that is connected to the pod network. You can configure additional network interfaces for your VM. For each field, you have several options to customize your template:<ul>
      <li><strong>Interface model: </strong>You can choose either <code>virtio</code> or <code>e1000e</code>, based on your VM's needs and required performance. The <code><mark class="marker-yellow">virtio</mark></code><mark class="marker-yellow"> model is optimized for performance</mark>, and most Linux distributions support it. <mark class="marker-yellow">Additional drivers are needed for Windows VMs</mark>. Although most operating systems, including Windows, support the <code>e1000e</code> model, its performance is slower than the <code>virtio</code> model.</li>
      <li><strong>Network: </strong>You can select from a list of available network attachment definitions to connect to additional networks. Additional networks must use the <code>bridge</code> binding method.</li>
      <li><strong>Type: </strong>You can select from a list of binding methods. You must use the <code>masquerade</code> binding method on the default pod network. Additional networks must use the <code>bridge</code> binding method.</li>
      <li><strong>MAC address: </strong>You can specify a custom MAC address for the network interface. MAC addresses are automatically assigned unless you specify a custom address.</li>
    </ul>
  </li>
  <li><strong>Scripts: </strong>In this field, you configure <code>cloud-init</code> on Linux systems, add authorized SSH keys, or configure Sysprep for Windows machines. Both <code>cloud-init</code> and <code>sysprep</code> install tools and packages, configure users and passwords, and manage system applications.</li>
</ul>
<h3>Virtual Machine Instance Types</h3>
<ul>
  <li>Instance types define resources and characteristics to apply to new VMs. Instance types must define CPU and memory resources. All other attributes are optional.<ol>
      <li><code><strong>cx1.~:</strong></code>The <i>CX Series</i> (an abbreviation of <mark class="marker-yellow">"Compute Exclusive</mark>") <mark class="marker-yellow">provides exclusive compute resources for compute-intensive applications</mark>. The exclusive resources are given to the compute threads of the VM. To ensure that these exclusive compute resources are available, some additional cores (depending on the number of disks and NICs) are requested to offload the I/O threading from the cores that are dedicated to the workload. In addition, in this series, the NUMA topology of the used cores is provided to the VM.</li>
      <li><code><strong>gn1.~:</strong></code>The <i>GN Series</i> (an abbreviation of "GPU NVIDIA") <mark class="marker-yellow">provides instance types for VMs with attached NVIDIA GPU resources</mark>. This series is intended for VMs that consume GPUs from the <a href="https://github.com/NVIDIA/gpu-operator">NVIDIA GPU Operator</a>, which is available on OpenShift via OperatorHub.</li>
      <li><code><strong>m1.~: </strong></code>The <i>M Series</i> (an abbreviation of "Memory") <mark class="marker-yellow">provides resources for memory-intensive applications.</mark></li>
      <li><code><strong>n1.~: </strong></code>The <i>N Series</i> (an abbreviation of "Network")<mark class="marker-yellow"> provides resources for network-intensive DPDK applications</mark>, such as VNFs. This series of instance types requires nodes that can run DPDK workloads, and the node must have the <code>node-role.kubevirt.io/worker-dpdk</code> label.</li>
      <li><code><strong>u1.~: </strong></code>The <i>U Series</i> (an abbreviation of "Universal") <mark class="marker-yellow">provides resources for general-purpose applications.</mark> VMs of instance types share physical CPU cores on a time-slice basis with other VMs.</li>
    </ol>
  </li>
</ul>
<pre><code class="language-plaintext">oc get vmclusterinstancetypes</code></pre>
<h3>Virtual Machine Preferences</h3>
<ul>
  <li>OpenShift Virtualization includes custom resource definitions for Virtual Machine Cluster Preferences (VMCP), which is a cluster-wide resource, and Virtual Machine Preferences (VMP), which is a namespaced resource.</li>
  <li>VMCP and VMP resources contain<mark class="marker-yellow"> optional preferences for the VM</mark>, such as domain devices, machine, and resource settings.&nbsp;</li>
  <li>VMCP and VMP attributes can be overridden when configuring a VM.</li>
</ul>
<h3>Bootable Volumes</h3>
<ul>
  <li>Bootable volumes are sealed golden images that are used as boot sources when creating VMs and that are defined by a <code>datasource</code> resource that is included with OpenShift Virtualization.</li>
  <li>The <code>datasource</code> metadata includes a recommended default instance type and a virtual machine preference.</li>
  <li>Set the <code>enableCommonBootImageImport</code> feature gate in the HyperConverged configuration to <code>true</code> to download common bootable images in <code>openshift-virtualization-os-images</code> project.</li>
</ul>
<pre><code class="language-plaintext"> oc get datasource -A
Name:         centos-stream9
Namespace:    openshift-virtualization-os-images
...output omitted...
Labels: instancetype.kubevirt.io/default-instancetype=u1.medium
        instancetype.kubevirt.io/default-preference=centos.stream9
...output omitted...
Spec:
  Source:
    Snapshot:
      Name:       centos-stream9-583318eb5646
      Namespace:  openshift-virtualization-os-images
    ...output omitted...</code></pre>
<ul>
  <li>The <code>dataimportcron</code> resource defines a cron job for recurring polling or importing disk images as PVCs into a golden image namespace.</li>
</ul>
<pre><code class="language-plaintext"> oc describe dataimportcrons rhel9-image-cron \
  -n openshift-virtualization-os-images
...output omitted...
Spec:
...output omitted...
  Schedule:             29 11/12 * * *
  Template:
    Metadata:
    Spec:
      Source:
        Registry:
          Image Stream:  rhel9-guest
          Pull Method:   node
      Storage:
        Resources:
          Requests:
            Storage:  30Gi
...output omitted...</code></pre>
<pre><code class="language-plaintext"> virtctl create vm --name rhel9-instancetype \
    --instancetype m1.large --infer-preference \
    --volume-datasource rhel9 &gt; rhel9-instancetype.yaml</code></pre>
<h3>Initial Run Configuration</h3>
<ul>
  <li>The images from Red&nbsp;Hat include the <code>cloud-init</code> utility</li>
</ul>
<figure class="table" style="width:1170px;">
  <table>
    <thead>
      <tr>
        <th style="border-bottom:2px solid rgb(221, 221, 221);border-top:0px;padding:8px;vertical-align:top;">Module name</th>
        <th style="border-bottom:2px solid rgb(221, 221, 221);border-top:0px;padding:8px;vertical-align:top;">Usage</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><code>users</code></td>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">This module configures users and groups.</td>
      </tr>
      <tr>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><code>rh_subscription</code></td>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Register a Red&nbsp;Hat system, either by a username and a password, or by an activation key and an organization.</td>
      </tr>
      <tr>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><code>yum_repos</code></td>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Add <code>yum</code> or <code>dnf</code> repository configuration to <code>/etc/yum.repos.d</code>.</td>
      </tr>
      <tr>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><code>ca_certs</code></td>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Add CA certificates to the system CA store and update any related files by using the appropriate operating system-specific utility.</td>
      </tr>
      <tr>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><code>rsyslog</code></td>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Configure remote system logging by using <code>rsyslog</code>.</td>
      </tr>
      <tr>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><code>write_files</code></td>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Write arbitrary content to files and optionally set permissions.</td>
      </tr>
      <tr>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><code>runcmd</code></td>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Run arbitrary commands at a <code>rc.local</code>-like time frame with output to the console.</td>
      </tr>
    </tbody>
  </table>
</figure>
<pre><code class="language-plaintext">#cloud-config
users:
  - default   1
  - name: devops  2
    gecos: Ansible account
    sudo: ["ALL=(ALL) NOPASSWD:ALL"]  3
    groups: wheel,adm,systemd-journal
    ssh_authorized_keys:  4
      - ssh-rsa AA...vz devops@example.com
chpasswd:
  list: |
    root:password
    cloud-user:mypassword
    devops:mypassword2
  expire: False 5
locale: es_MX.UTF-8  6</code></pre>
<figure class="table">
  <table style="background-color:rgb(255, 255, 255);">
    <tbody>
      <tr>
        <td style="padding:0px;vertical-align:top;">
          <figure class="image image_resized" style="width:22px;"><img src="https://rol.redhat.com/rol/static/roc/Common_Content/images/1.svg" alt="1"></figure>
        </td>
        <td style="padding:0px;vertical-align:top;">Create the default <code>cloud-init</code> user.</td>
      </tr>
      <tr>
        <td style="padding:0px;vertical-align:top;">
          <figure class="image image_resized" style="width:22px;"><img src="https://rol.redhat.com/rol/static/roc/Common_Content/images/2.svg" alt="2"></figure>
        </td>
        <td style="padding:0px;vertical-align:top;">Create the <code>devops</code> user.</td>
      </tr>
      <tr>
        <td style="padding:0px;vertical-align:top;">
          <figure class="image image_resized" style="width:22px;"><img src="https://rol.redhat.com/rol/static/roc/Common_Content/images/3.svg" alt="3"></figure>
        </td>
        <td style="padding:0px;vertical-align:top;">Add <code>sudo</code> privileges.</td>
      </tr>
      <tr>
        <td style="padding:0px;vertical-align:top;">
          <figure class="image image_resized" style="width:22px;"><img src="https://rol.redhat.com/rol/static/roc/Common_Content/images/4.svg" alt="4"></figure>
        </td>
        <td style="padding:0px;vertical-align:top;">Add SSH public keys.</td>
      </tr>
      <tr>
        <td style="padding:0px;vertical-align:top;">
          <figure class="image image_resized" style="width:22px;"><img src="https://rol.redhat.com/rol/static/roc/Common_Content/images/5.svg" alt="5"></figure>
        </td>
        <td style="padding:0px;vertical-align:top;">Force a password change at login: true or false.</td>
      </tr>
      <tr>
        <td style="padding:0px;vertical-align:top;">
          <figure class="image image_resized" style="width:22px;"><img src="https://rol.redhat.com/rol/static/roc/Common_Content/images/6.svg" alt="6"></figure>
        </td>
        <td style="padding:0px;vertical-align:top;">Change the system locale.</td>
      </tr>
    </tbody>
  </table>
</figure>
<h3>Creating Custom Templates</h3>
<ul>
  <li>Virtual machine templates are a Red&nbsp;Hat OpenShift <code>template</code> resource. The template includes a list of parameterized resources, and must be processed to generate a resource definition that can be created.</li>
  <li>A virtual machine template defines a <code>virtualmachine</code> resource.</li>
  <li>The templates from Red&nbsp;Hat OpenShift and the OpenShift Virtualization operator are in a namespace that is available to all users.&nbsp;</li>
</ul>
<pre><code class="language-plaintext">oc get templates -n openshif</code></pre>
<ul>
  <li>Create custom templates by cloning the default templates from RedHat <strong>Virtualization</strong> → <strong>Templates, Actions</strong> → <strong>Clone</strong>.</li>
  <li>To create a template, go to <strong>Virtualization</strong> → <strong>Templates</strong> and click <strong>Create Template</strong>. Customize the parameters in the YAML editor and click <strong>Create</strong>.</li>
</ul>
<pre><code class="language-plaintext">apiVersion: template.openshift.io/v1
kind: Template	
metadata:
  name: my-custom-template	
  namespace: replicating-create	
  labels:
    os.template.kubevirt.io/rhel9: "true"
    template.kubevirt.io/type: vm
    workload.template.kubevirt.io/server: "true"
  annotations:
    description: VM template example
    iconClass: icon-rhel
objects:
  - apiVersion: kubevirt.io/v1
    kind: VirtualMachine	1
    metadata:
      labels:
        app: ${NAME}	2
        kubevirt.io/dynamic-credentials-support: "true"
        vm.kubevirt.io/template: replicating-create
        vm.kubevirt.io/template.namespace: replicating-create
        vm.kubevirt.io/template.revision: "1"
      name: ${NAME}	3
    spec:
    dataVolumeTemplates:
    - apiVersion: cdi.kubevirt.io/v1beta1
      kind: DataVolume
      metadata:
        name: ${NAME}	
      spec:
        storage:
          resources:
            requests:
              storage: 30Gi
          storageClassName: ocs-external-storagecluster-ceph-rbd-​virtualization
        source:	
          http:
            url: "https://example.com​/openshift4​/images/​rhel9-mariadb.qcow2"
    running: false
    template:
      metadata:
      spec:
        architecture: amd64
        volumes:
        - dataVolume:
            name: ${NAME}	
          name: rootdisk
        - cloudInitNoCloud:
            userData: |-
              #cloud-config
              user: cloud-init
              password: ${CLOUD_USER_PASSWORD}	
              chpasswd: { expire: False }
              name: cloudinitdisk
parameters:
- description: VM name
  from: rhel9-[a-z0-9]{16}
  generate: expression
  name: NAME
- name: CLOUD_USER_PASSWORD	
  description: Randomized password for the cloud-init user cloud-user
  from: '[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}'	
  generate: expression</code></pre>
<figure class="table">
  <table style="background-color:rgb(255, 255, 255);">
    <tbody>
      <tr>
        <td style="padding:0px;vertical-align:top;">
          <figure class="image image_resized" style="width:22px;"><img src="https://rol.redhat.com/rol/static/roc/Common_Content/images/1.svg" alt="1"></figure>
        </td>
        <td style="padding:0px;vertical-align:top;">Create a VM object.</td>
      </tr>
      <tr>
        <td style="padding:0px;vertical-align:top;">
          <figure class="image image_resized" style="width:22px;"><img src="https://rol.redhat.com/rol/static/roc/Common_Content/images/2.svg" alt="2"></figure>
        </td>
        <td style="padding:0px;vertical-align:top;">The <code>NAME</code> variable is expanded when the template is processed.</td>
      </tr>
      <tr>
        <td style="padding:0px;vertical-align:top;">
          <figure class="image image_resized" style="width:22px;"><img src="https://rol.redhat.com/rol/static/roc/Common_Content/images/3.svg" alt="3"></figure>
        </td>
        <td style="padding:0px;vertical-align:top;">A variable can be used many times.</td>
      </tr>
    </tbody>
  </table>
</figure>
<h3>Creating Custom Instance Types</h3>
<ul>
  <li>An instance type can also be cloned. Go to <strong>Virtualization</strong> → <strong>InstanceTypes</strong> and click the vertical ellipsis for the instance type to clone.</li>
</ul>
<pre><code class="language-plaintext">virtctl create instancetype --name example-gpu \
  --cpu 2 --memory 256Mi --gpu name:gpu1,devicename:nvidia
apiVersion: instancetype.kubevirt.io/v1beta1
kind: VirtualMachineClusterInstancetype
metadata:
  creationTimestamp: null
  name: example-gpu
spec:
  cpu:
    guest: 2
  gpus:
  - deviceName: nvidia
    name: gpu1
  memory:
    guest: 256Mi</code></pre>
<h3>Creating Custom Virtual Machine Preferences</h3>
<ul>
  <li><strong>Virtualization</strong> → <strong>Preferences</strong>. You can edit or clone the preference resources by using the same procedure as for instance types.</li>
  <li>create preferences with the <code>virtctl</code> command. By default, a <code>virtualmachineclusterpreferences</code> resource is created. Use the <code>--namespaced</code> option to create a <code>virtualmachinepreferences</code> resource that is available only in the current namespace</li>
</ul>
<pre><code class="language-plaintext">virtctl create preference --name example-preference \
  --volume-storage-class ocs-external-storagecluster-ceph-rbd-virtualization
apiVersion: instancetype.kubevirt.io/v1beta1
kind: VirtualMachineClusterPreference
metadata:
  creationTimestamp: null
  name: example-preference
spec:
  volumes:
    preferredStorageClassName: ocs-external-storagecluster-ceph-rbd-virtualizati</code></pre>
<h3>Adding Bootable Volumes</h3>
<ul>
  <li>when enabling <mark class="marker-yellow">enableCommonBootImageImport</mark> &nbsp;The installation creates <code>imagestream</code>, <code>datasource</code>, and <code>dataimportcron</code> resources in the <code>openshift-virtualization-os-images</code> namespace.</li>
  <li>&nbsp;A <code>dataImportCronTemplates</code> section is added to the <code>spec</code> of the <code>hco</code> resource. This section contains a list of <code>dataimportcron</code> resource specifications.&nbsp;</li>
</ul>
<blockquote>
  <p>For disconnected clusters, Red&nbsp;Hat recommends disabling automatic updates. Leaving automatic updates enabled uses resources and fills log files with each attempt to import the images.</p>
</blockquote>
<ul>
  <li>When the <code>enableCommonBootImageImport</code> feature gate is disabled, <code>datasource</code> objects are reset so that they no longer point to the original boot source and any system default <code>dataimportcron</code> resources are deleted.<ul>
      <li>administrator can manually provide a boot source by creating a new PVC or volume snapshot for the <code>datasource</code> object and then populating it with an operating system image.</li>
    </ul>
  </li>
  <li>For the<mark class="marker-yellow"> custom image to be detected as an available boot source</mark>, the name of the image's <code>managedDataSource</code> <mark class="marker-yellow">must match the name of the template's</mark> <code>DataSource</code>, which is defined in <code>spec.dataVolumeTemplates.spec.sourceRef.name</code> in the VM template YAML file.</li>
  <li>To add custom bootable volumes in the web console, go to <strong>Virtualization</strong> → <strong>Bootable volumes</strong> and select <strong>Add&nbsp;volume</strong> → <strong>With form</strong>.</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
