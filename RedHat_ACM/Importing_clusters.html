<!--
title: Chapter two ~ Earth
description: 
published: true
date: 2025-10-17T08:35:57.488Z
tags: 
editor: ckeditor
dateCreated: 2025-10-16T19:32:45.334Z
-->

<h3>Red&nbsp;Hat Advanced Cluster Management Lifecycle</h3>
<ul>
  <li>The <strong>multicluster engine operator </strong>uses the <strong>Hive operator</strong> that is provided with Red&nbsp;Hat OpenShift Container Platform (RHOCP) to provision clusters for all <mark class="marker-yellow">providers except the on-premise clusters and hosted control planes.</mark></li>
  <li>on-premise clusters, multicluster engine operator uses the<strong> central infrastructure management and the assisted installer function from RHOCP.</strong></li>
  <li>The <strong>Hive Operator</strong> is a Kubernetes Operator developed by Red Hat to automate the provisioning, management, and lifecycle of OpenShift clusters—especially in large-scale, multi-cluster environments.</li>
  <li>Cloud Native Computing Foundation (CNCF) Kubernetes Conformance Program: ensures that Kubernetes implementations from different vendors meet a consistent set of standards, <strong>enabling interoperability</strong>, reliability, and portability across platforms.<ul>
      <li>Amazon Web Services</li>
      <li>Amazon Web Services GovCloud</li>
      <li>Microsoft Azure</li>
      <li>Google Cloud Platform</li>
      <li>VMware vSphere</li>
      <li>Red&nbsp;Hat OpenStack Platform</li>
      <li>On-premise</li>
    </ul>
  </li>
</ul>
<h2>Web console</h2>
<h3>Infrastructure tab</h3>
<figure class="table" style="width:1170px;">
  <table style="background-color:rgb(255, 255, 255);">
    <tbody>
      <tr>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Clusters</td>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Use to create clusters or to import existig clusters.</td>
      </tr>
      <tr>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Automation</td>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Use to create an Ansible template. You can create <strong>prehook and posthook Ansible job instances&nbsp;</strong><br>that occur before or after creating or upgrading your clusters.</td>
      </tr>
      <tr>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Host Inventory</td>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Use to create a host inventory to discover physical or virtual machines that you can install your RHOCP clusters on.</td>
      </tr>
      <tr>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Virtual Machines</td>
        <td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">Use to manage virtual machines across all clusters.</td>
      </tr>
    </tbody>
  </table>
</figure>
<p>&nbsp;</p>
<h3>Creating clusters</h3>
<ol>
  <li>Create <code>ClusterDeployment</code> Custom Resource (CR): Core <mark class="marker-yellow">Hive resource</mark> to control the lifecycle of a cluster and the Hive API entry point</li>
  <li>The <code>ClusterDeployment</code> CR references the short name of a <code>ClusterImageSet</code> CR to specify<mark class="marker-green"> <strong>the RHOCP version to the new cluster.</strong></mark></li>
  <li>The <code>ClusterImageSet</code> CR: A CRD that is provided by the Hive operator to define the RHOCP installer images. That custom resource can be pointed at by ClusterDeployment resource to create new clusters on <strong>different platforms or provisioning workflows(agent-based, image-based(using images to install ocp)</strong>, ensuring <strong>version consistency</strong>.<ul>
      <li><strong>Immutable reference: </strong>The CRD reference installer images by digest, so it ensures that the same installer image version is used always</li>
      <li><strong>Decoupling installer from CRs: </strong>Upgrades and deploying new minor versions involve creating a <code>ClusterImageSet</code> CR, not editing every <code>ClusterDeployment</code> CR.</li>
      <li><strong>Central catalog of images: </strong>Administrators maintain a library of approved RHOCP installer images. Select the latest-approved or stable-4.x.x <code>ClusterImageSet</code> CR to avoid manually searching through quay.io or registry.redhat.io.</li>
    </ul>
  </li>
</ol>
<blockquote>
  <p>An <strong>RPM-hosted installer image</strong> is a pre-built container image that contains:</p>
  <p>The <strong>OpenShift installer binary</strong></p>
  <p>All required <strong>RPM packages</strong> for bootstrapping and configuring the cluster</p>
  <p>Dependencies for the <strong>Agent-based Installer</strong> or <strong>Zero Touch Provisioning (ZTP)</strong></p>
</blockquote>
<pre><code class="language-plaintext">apiVersion: hive.openshift.io/v1
kind: ClusterImageSet
metadata:
  labels:
    channel: fast
    visible: 'true'
  name: &lt;referenced by ClusterDeployment
spec:
  releaseImage: quay.io/openshift-release-dev/ocp-release:4.x.1-x86_64 2 &gt; version of ocp installer </code></pre>
<pre><code class="language-plaintext">apiVersion: hive.openshift.io/v1
kind: ClusterDeployment
metadata:
  name: mycluster
  namespace: mynamespace
spec:
  baseDomain: hive.example.com
  clusterName: mycluster
  platform:
    aws:
      credentialsSecretRef:
        name: mycluster-aws-creds
      region: us-east-1
  provisioning:
    imageSetRef:
      name: &lt;name of clusterImageSet&gt;
    installConfigSecretRef:
      name: mycluster-install-config
    sshPrivateKeySecretRef:
      name: mycluster-ssh-key
  pullSecretRef:
    name: mycluster-pull-secret</code></pre>
<p>&nbsp;</p>
<p><strong>&nbsp;4. </strong>The Hive controller watches the <code>imageSetRef.name</code> field, looks up the corresponding <code>ClusterImageSet</code> CR, and uses its <code>spec.releaseImage</code> to provision the cluster.</p>
<h3><strong>Upgrading a cluster</strong></h3>
<ol>
  <li>Just change the imageSetRef.name to a later one with higher version</li>
</ol>
<h3>Importing Existing Clusters</h3>
<p>From the RHACM web console, go to the <strong>Infrastructure</strong> → <strong>Clusters</strong> menu.</p>
<p>Click <strong>Import cluster</strong>.</p>
<p>Provide the required import cluster name.</p>
<p>Optionally select a cluster set for the import. The import uses the <code>default</code> managed cluster set if nothing is selected.</p>
<p>Optionally add labels. If you remove a hub cluster and try to import it again, you must add the <code>local-cluster:true</code> label to the <code>ManagedCluster</code> CR.</p>
<p>For the <code>Import mode</code>, use <code>Run import command manually</code>.</p>
<p>Click <strong>Next</strong>.</p>
<p>Click <strong>Next</strong> on the <code>Automation</code> page.</p>
<p>Click <strong>Generate command</strong> on the <code>Review</code> page.</p>
<p>Click <strong>Copy command</strong> to copy the generated command and token to the clipboard.</p>
<p>Paste and run the copied command in a terminal session on the target cluster.</p>
<p>Return to the <strong>Infrastructure</strong> → <strong>Clusters</strong> menu.</p>
<p>The newly imported cluster is immediately displayed in the <strong>Infrastructure</strong> → <strong>Clusters</strong> menu. It takes several minutes to see all the cluster details, because RHACM is installing the add-ons in the managed cluster.</p>
<ul>
  <li>import modes:<ul>
      <li>Run import command manually on the target cluster</li>
      <li>enter the API url and API token for the target cluster</li>
      <li>KubeConfig certs</li>
    </ul>
  </li>
</ul>
<h4>Scaling a Cluster</h4>
<ol>
  <li><code>SiteConfig</code> operator: Red Hat OpenShift component that automates cluster provisioning and configuration—especially for edge and single-node deployments—using declarative YAML resources.<ul>
      <li>It introduces a <strong>ClusterInstance API</strong>, which <mark class="marker-yellow">separates cluster definitions from installation methods</mark>, making it easier to manage clusters declaratively.</li>
      <li>A template-driven cluster provisioning solution with the <code>ClusterInstance</code> API</li>
      <li>Dynamically generates installation manifests based on user-defined templates that are instantiated from the data in the <code>ClusterInstance</code> CR.</li>
      <li>overview:<ol>
          <li>Create one or more sets of <mark class="marker-yellow">installation templates </mark>that are used on the hub cluster</li>
          <li>Create a <code>ClusterInstance</code> CR that<mark class="marker-yellow"> references those installation templates</mark> and supporting manifests.</li>
          <li>After the resources are created, the <code>SiteConfig</code> operator reconciles the <code>ClusterInstance</code> CR by <mark class="marker-yellow">populating the template fields that are referenced in the CR.</mark></li>
          <li>The <code>SiteConfig</code> operator validates and renders the installation manifests, and then the operator performs a dry run.</li>
          <li>If the dry run is successful, then the manifests are created, and then the <mark class="marker-yellow">underlying operators consume and process the manifests to start the instillation.</mark></li>
          <li>The <code>SiteConfig</code> operator <mark class="marker-pink">continuously monitors</mark> for changes in the associated <code>ClusterDeployment</code> CR and updates the <code>ClusterInstance</code> <strong>status field accordingly.</strong></li>
        </ol>
      </li>
    </ul>
  </li>
</ol>
<blockquote>
  <p>To scale the cluster, set the <code>clusterinstance.spec.nodes</code> list to use the appropriate number of nodes for the installation.</p>
</blockquote>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
