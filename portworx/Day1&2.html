<!--
title: Operations
description: 
published: true
date: 2025-12-15T12:24:07.898Z
tags: 
editor: ckeditor
dateCreated: 2025-11-17T09:09:20.895Z
-->

<h1>Observability</h1>
<ul>
  <li>In 3.5 Portworx uses OpenShiftâ€™s Prometheus deployment for monitoring, rather than deploying its own.</li>
  <li>To export Portworx Prometheus metrics to Openshift:<ul>
      <li>Disable the Portworx Prometheus deployment in the Portworx StorageCluster spec:</li>
    </ul>
  </li>
</ul>
<pre><code class="language-plaintext">spec:
  monitoring:
    prometheus:
      enabled: false
      exportMetrics: true
      alertManager:
        enabled: false</code></pre>
<p>&nbsp;</p>
<ul>
  <li>&nbsp;<ul>
      <li>Enable user workloads monitoring</li>
    </ul>
  </li>
</ul>
<pre><code class="language-plaintext">apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-monitoring-config
  namespace: openshift-monitoring
data:
  config.yaml: |
    enableUserWorkload: true</code></pre>
<p>&nbsp;</p>
<ul>
  <li>&nbsp;<ul>
      <li>Fetch the Thanos host, which is part of the OpenShift monitoring stack:</li>
    </ul>
  </li>
</ul>
<pre><code class="language-plaintext">oc get route thanos-querier -n openshift-monitoring -o json | jq -r '.spec.host'</code></pre>
<h2><strong>Configure Grafana</strong></h2>
<pre><code class="language-plaintext">#!/bin/bash
curl -O https://docs.portworx.com/portworx-enterprise/samples/k8s/pxc/grafana-dashboard-config.yaml
curl -O https://docs.portworx.com/portworx-enterprise/samples/k8s/pxc/grafana-datasource-ocp.yaml
oc  -n portworx apply -f https://docs.portworx.com/portworx-enterprise/samples/k8s/pxc/grafana-service-account.yaml
oc -n portworx adm policy add-cluster-role-to-user cluster-monitoring-view -z grafana
oc -n portworx create token grafana --duration=8760h</code></pre>
<p>&nbsp;</p>
<ul>
  <li>Modify the <code>grafana-datasource-ocp.yaml</code> file:<ul>
      <li>On the <code>url: https://&lt;THANOS_QUERIER_HOST&gt;</code> line, replace <code>&lt;THANOS_QUERIER_HOST&gt;</code></li>
      <li>On the <code>httpHeaderValue1: 'Bearer &lt;BEARER_TOKEN&gt;'</code> line</li>
    </ul>
  </li>
  <li>Create a configmap for the dashboard</li>
</ul>
<pre><code class="language-plaintext">oc -n portworx create configmap grafana-dashboard-config --from-file=grafana-dashboard-config.yaml
oc -n portworx create configmap grafana-source-config --from-file=grafana-datasource-ocp.yaml</code></pre>
<p>&nbsp;</p>
<ul>
  <li>Download the dashboards</li>
</ul>
<pre><code class="language-plaintext">curl "https://docs.portworx.com/portworx-enterprise/samples/k8s/pxc/portworx-cluster-dashboard.json" -o portworx-cluster-dashboard.json &amp;&amp; \
curl "https://docs.portworx.com/portworx-enterprise/samples/k8s/pxc/portworx-node-dashboard.json" -o portworx-node-dashboard.json &amp;&amp; \
curl "https://docs.portworx.com/portworx-enterprise/samples/k8s/pxc/portworx-volume-dashboard.json" -o portworx-volume-dashboard.json &amp;&amp; \
curl "https://docs.portworx.com/portworx-enterprise/samples/k8s/pxc/portworx-performance-dashboard.json" -o portworx-performance-dashboard.json &amp;&amp; \
curl "https://docs.portworx.com/portworx-enterprise/samples/k8s/pxc/portworx-etcd-dashboard.json" -o portworx-etcd-dashboard.json &amp;&amp; \
# Optional: Following file is required only if you use Stork for DR/migrations
curl "https://docs.portworx.com/portworx-enterprise/samples/k8s/pxc/portworx-dr-dashboard.json" -o portworx-dr-dashboard.json</code></pre>
<p>&nbsp;</p>
<ul>
  <li>Deploy Garfana</li>
</ul>
<pre><code class="language-plaintext">oc -n portworx apply -f https://docs.portworx.com/portworx-enterprise/samples/k8s/pxc/grafana-ocp.yaml</code></pre>
<h1><strong>Create Snapshots in Portworx</strong></h1>
<h4><strong>Local Snapshots</strong></h4>
<ul>
  <li>&nbsp;</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
