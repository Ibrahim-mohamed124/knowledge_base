<!--
title: Intro
description: 
published: true
date: 2025-10-03T20:01:56.361Z
tags: acs, application security, images scanning, dast
editor: ckeditor
dateCreated: 2025-09-30T06:04:08.431Z
-->

<h1>ACS Architecture</h1>
<p>⇒ Distributed architecture to minimize the impact of the underlaying nodes and support high scale deployments</p>
<figure class="image"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Advanced_Cluster_Security_for_Kubernetes-4.5-Architecture-en-US/images/d0f8b5ac858b10110221e528d52b4797/acs-architecture-scannerv4.png" alt="Red&nbsp;Hat Advanced Cluster Security for Kubernetes architecture for Kubernetes"></figure>
<p>Services:</p>
<ul>
  <li>Central: a service installed on one cluster</li>
  <li>secure cluster services: installed on each cluster</li>
</ul>
<p>Instillation methods:</p>
<ol>
  <li>Operator: installs a lightweight version of the Scanner on each cluster to scan the images in the integrated openshift registry.</li>
  <li>Helm chart: do not install the lightweight version of the Scanner by default, must explicitly set scanner.disable=false</li>
  <li>roxctl method: cannot install the lightweight version of the Scanner</li>
</ol>
<p>&nbsp;</p>
<h2>Central Services</h2>
<ol>
  <li>Central: application management interface for API interactions and users</li>
  <li>Central DB: Postgesql 13 for data persistency</li>
  <li>Scanner V4: vulnerability scanner for container images that is built on ClairCore for the Clair scanner<ol>
      <li>support the scanning of language and OS dependencies</li>
      <li>Used with StackRox scanner to provide node and platform scanning</li>
      <li>Components:<ol>
          <li>scanner v4 indexer: image indexing, pulls the images from the registry and finds the base OS of the image. It also looks for the installed packages, then stores this data in an index report.</li>
          <li>scanner v4 matcher: consumes the index report to match the findings with the vulnerabilities in the &nbsp;scanner v4 db, then outputs a vulnerability report. It also updates the scanner v4 db to the latest.</li>
          <li>scanner v4 db: stores the vulnerability data in a PVC</li>
        </ol>
      </li>
    </ol>
  </li>
  <li>stackRox scanner: depend on clair v2 scanner to scan the cluster nodes and the whole platform</li>
  <li>scanner DB: the database for stockRox scanner</li>
</ol>
<p>&nbsp;</p>
<h3>Advisories&nbsp;</h3>
<ul>
  <li><a href="https://secdb.alpinelinux.org/"><u>Alpine Security Database</u></a></li>
  <li>Data tracked in <a href="https://alas.aws.amazon.com/index.html"><u>Amazon Linux Security Center</u></a></li>
  <li><a href="https://security-tracker.debian.org/tracker/data/json"><u>Debian Security Tracker</u></a></li>
  <li><a href="https://linux.oracle.com/security/oval"><u>Oracle OVAL</u></a></li>
  <li><a href="https://packages.vmware.com/photon/photon_oval_definitions/"><u>Photon OVAL</u></a></li>
  <li><a href="https://access.redhat.com/security/data/oval/v2/"><u>Red&nbsp;Hat OVAL</u></a></li>
  <li><a href="https://access.redhat.com/security/data/metrics/cvemap.xml"><u>Red&nbsp;Hat CVE Map</u></a>: This is used for images which appear in the <a href="https://catalog.redhat.com/software/containers/explore"><u>Red&nbsp;Hat Container Catalog</u></a>.</li>
  <li><a href="https://support.novell.com/security/oval/"><u>SUSE OVAL</u></a></li>
  <li><a href="https://security-metadata.canonical.com/oval/"><u>Ubuntu OVAL</u></a></li>
  <li><a href="https://osv.dev/"><u>OSV</u></a>: This is used for language-related vulnerabilities, such as Go, Java, Node.js (JavaScript), Python, and Ruby. This source might provide GitHub Security Advisory (GHSA) IDs rather than CVE numbers for vulnerabilities. The RHACS Scanner V4 also uses the OSV database available at <a href="https://osv.dev/"><u>OSV.dev</u></a> under <a href="https://github.com/google/osv.dev/blob/master/LICENSE"><u>this license</u></a>.</li>
  <li><a href="https://nvd.nist.gov/vuln/search"><u>NVD</u></a>: This is used for various purposes such as filling in information gaps when vendors do not provide information. For example, Alpine does not provide a description, CVSS score, severity, or published date.</li>
  <li><a href="https://github.com/stackrox/stackrox/blob/master/scanner/updater/manual/vulns.go"><u>StackRox</u></a>: The upstream StackRox project maintains a set of vulnerabilities that might not be discovered due to data formatting from other sources or absence of data.</li>
</ul>
<p>The Scanner V4 Indexer uses the following files to index Red&nbsp;Hat containers:</p>
<ul>
  <li><a href="https://www.redhat.com/security/data/metrics/repository-to-cpe.json"><u>repository-to-cpe.json</u></a>: Maps RPM repositories to their related CPEs, which is required for matching vulnerabilities for RHEL-based images.</li>
  <li><a href="https://access.redhat.com/security/data/metrics/container-name-repos-map.json"><u>container-name-repos-map.json</u></a>: This matches container names to the repositories to which they are shipped.</li>
</ul>
<h2>Secured clusters' services</h2>
<ol>
  <li>sensor: Analyze and monitor the cluster<ul>
      <li>Listen to openshfit platform and Collector APIs</li>
      <li>Report the current state of the cluster to the central services</li>
      <li>Triggers a deploy-time and runtime violations according to a defined policy</li>
      <li>Responsible for applying network policies, reprocessing of RHACS policies, and interacting with admission controllers</li>
    </ul>
  </li>
  <li>Admission controllers: validating and mutating</li>
  <li>Collector: &nbsp;analyze and monitor the container's runtime and network activities and report it to the sensor</li>
  <li>StackRox scanner: in ocp, ACS install a Scanner-slim version to analyze the images in the internal registry and other registries</li>
  <li>scanner db</li>
  <li>scanner V4: optionally if enabled</li>
</ol>
<h2>External Components</h2>
<ol>
  <li>Third-party systems: CI/CD, logging, email …</li>
  <li>roxctl: cli to interact with ACS</li>
  <li>Image registries: the pull secrets in each secured cluster are used to automatically configure image registries intergrations</li>
  <li><strong>definitions.stackrox.io: </strong>Aggregates the vulnerability data from various sources and pass this data to the Central</li>
  <li><strong>collector-modules.stackrox.io:&nbsp;</strong> Central interact with this endpoint to obtain supported kernel modules and pass the data to the collocter</li>
</ol>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
