<!--
title: Advanced configs
description: 
published: true
date: 2026-01-05T19:37:50.830Z
tags: 
editor: ckeditor
dateCreated: 2026-01-04T18:19:55.562Z
-->

<h3>Sync Hooks and Sync Waves</h3>
<ul>
  <li>Using both these features, we can create deployment playbooks to define the chorological relationship between resources in the aspect of creation, updating, and deleting.</li>
  <li>Depend mainly on annotating &nbsp;the manifests to categorize them into groups</li>
</ul>
<h6>Sync Hooks</h6>
<ul>
  <li>Jobs run during the deployment to do certain functions in different phases &gt;&gt; &nbsp;<mark class="marker-yellow">argocd.argoproj.io/hook:</mark>
    <ul>
      <li>PreSync: run before the main sync to prepare &nbsp;for the sync</li>
      <li>Sync: resources deployment</li>
      <li>PostSync: after deploying the resources</li>
      <li>SyncFail: in case the main sync failed</li>
    </ul>
  </li>
  <li>These jobs are not cleaned automatically, so you have to use a clean up strategy for each job. <mark class="marker-yellow">argocd.argoproj.io/hook-delete-policy:&nbsp;</mark>
    <ul>
      <li>HookSuccedded: only delete the job only if it successful</li>
      <li>HookFailed: keep successful jobs</li>
    </ul>
  </li>
</ul>
<pre><code class="language-plaintext">apiVersion: batch/v1
kind: Job
metadata:
  name: cleanup-job
  annotations:
    argocd.argoproj.io/hook: PostSync
    argocd.argoproj.io/hook-delete-policy: HookFailed
spec:
  template:
    spec:
      containers:
      - name: cleanup
        image: alpine:3.12
        command: ["/bin/sh", "-c", "echo 'Running Cleanup Job...' &amp;&amp; sleep 10 &amp;&amp; echo 'Cleanup Complete.'"]
      restartPolicy: Never
  backoffLimit: 2</code></pre>
<p>&nbsp;</p>
<ul>
  <li>to skip hooks</li>
</ul>
<pre><code class="language-plaintext">argocd sync app --no-hooks</code></pre>
<h6>Sync waves</h6>
<ul>
  <li>Help in ordering resources deployments with the lowest order applied first</li>
  <li>resources with same order run in the same stage in different phases&nbsp;<mark class="marker-yellow"> argocd.argoproj.io/sync-wave: ‘x’</mark></li>
</ul>
<figure class="image image_resized" style="width:100%;"><img src="/hooks.png"></figure>
<blockquote>
  <p>The hook phase takes precedence over sync waves.</p>
</blockquote>
<h3>ApplicationSet</h3>
<ul>
  <li>A dynamic template for application resources&nbsp;<ul>
      <li>generators:<ul>
          <li>defines the target locations to deploy an app, state stores to get the state</li>
        </ul>
      </li>
      <li>template:&nbsp;<ul>
          <li>blueprint for the application with place holders&nbsp;</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<p>&nbsp;</p>
<figure class="image"><img src="/gen.png"></figure>
<p>&nbsp;</p>
<pre><code class="language-plaintext">apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
  name: guestbook
spec:
  goTemplate: true
  goTemplateOptions: ["missingkey=error"]
  generators:
  - list:
      elements:
      - cluster: engineering-dev
        url: https://1.2.3.4
      - cluster: engineering-prod
        url: https://2.4.6.8
      - cluster: finance-preprod
        url: https://9.8.7.6
  template:
    metadata:
      name: '{{.cluster}}-guestbook'
    spec:
      project: my-project
      source:
        repoURL: https://github.com/infra-team/cluster-deployments.git
        targetRevision: HEAD
        path: guestbook/{{.cluster}}
      destination:
        server: '{{.url}}'
        namespace: guestbook</code></pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
