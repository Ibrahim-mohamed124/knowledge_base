<!--
title: Open Virtual Networking - Kubernetes
description: 
published: true
date: 2025-12-29T14:13:58.199Z
tags: 
editor: ckeditor
dateCreated: 2025-12-28T12:03:56.739Z
-->

<blockquote>
  <p>an open-source project that provides a robust networking solution for Kubernetes clusters with OVN (Open Virtual Networking) and Open vSwitch (Open Virtual Switch) at its core. It is a Kubernetes networking conformant plugin written according to the CNI (Container Network Interface) specifications. OVN is an abstraction on top of Open vSwitch</p>
</blockquote>
<blockquote>
  <p>OpenFlow enables network controllers to determine the path of network packets across a network of switches. The controllers are distinct from the switches. This separation of the control from the forwarding allows for more sophisticated traffic management than is feasible using access control lists (ACLs) and routing protocols.</p>
  <p><code>OpenFlow</code> is a protocol for communicating with network switches and routers, providing a means for remotely controlling the flow of network traffic on a network device. This means that network administrators can configure, manage, and watch the flow of network traffic.</p>
</blockquote>
<h1>What is OVN</h1>
<ul>
  <li>OVN-Kubernetes is a series of daemons for OVS that transform virtual network configurations into <code>OpenFlow</code> rules.</li>
  <li>The OVN-Kubernetes plugin watches the Kubernetes API. It <mark class="marker-yellow">acts on the generated Kubernetes cluster events by creating and configuring the corresponding OVN logical constructs</mark> in the <mark class="marker-yellow">OVN database</mark> for those events.</li>
</ul>
<figure class="image"><img src="/ovnkube-introduction.png"></figure>
<ul>
  <li>The key functionalities and features that OVN-Kubernetes provides include:<ul>
      <li>Kubernetes Core Networking Conformance<ul>
          <li>Generic Network Virtualization Encapsulation GENEVE tunnels that enables pod-to-pod communication.</li>
          <li>Implements Kubernetes Services &amp; EndpointSlices through OVN Load Balancers.</li>
          <li>Implements Kubernetes NetworkPolicies and AdminNetworkPolicies through OVN Access Control Lists (ACLs).</li>
        </ul>
      </li>
      <li>Fine grained Cluster Egress Traffic Controls<ul>
          <li>Multiple External Gateways (MEG) allows for multiple dynamically or statically assigned egress next-hop gateways by utilizing OVN ECMP routing features.</li>
          <li>Implements Quality of Service (QoS) Differentiated Services Code Point (DSCP) for traffic egressing the cluster through OVN QoS.</li>
          <li>Provides ability to send egress traffic from cluster workloads using an admin-configured source IP (EgressIP) to outside the cluster using OVN Logical Router Policies and Network Address Translations.</li>
          <li>Provides ability to send egress traffic from cluster workloads using the service load balancer IP (EgressService) to outside the cluster using OVN Logical Router Policies and Network Address Translations</li>
          <li>Provides the ability to restrict egress traffic from cluster workloads (Egress Firewall) using OVN Access Control Lists.</li>
        </ul>
      </li>
      <li>Advanced Networking Features:<ul>
          <li>Implements Hybrid Networking to provide support for mixed Windows/Linux clusters using VXLAN tunnels.</li>
          <li>Provides IP Multicast using OVN IGMP snooping and relays.</li>
          <li><mark class="marker-yellow">Provides ability to offload networking tasks from CPU to NIC using OVS Hardware Offload thus providing increased data-plane performance.</mark></li>
          <li><mark class="marker-yellow">Adds support for creating secondary and local networks in addition to the default primary networks</mark></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<h3>Interconnect installation mode Architecture</h3>
<ul>
  <li>OVN Interconnection is a feature that allows connecting<mark class="marker-yellow"> multiple OVN deployments with OVN managed GENEVE tunnels.</mark></li>
  <li>OVN interconnection controller is a <mark class="marker-yellow">centralized daemon</mark> which communicates with<mark class="marker-yellow"> global interaction databases</mark> (IC_NB/IC_SB) to configure and exchange data with<mark class="marker-yellow"> local NB/SB databases </mark>for interconnecting with <mark class="marker-yellow">other OVN deployments</mark>.</li>
</ul>
<figure class="image"><img src="/ovnkube-distributed-components.png"></figure>
<ul>
  <li>The control plane has the <code>ovnkube-control-plane</code> pod in the <code>ovn-kubernetes</code> namespace</li>
  <li>ovnkube-control-plane pod<ul>
      <li>ovnkube-cluster-manager container:<ul>
          <li>OVN-Kubernetes component</li>
          <li>Watches K8s API for objects - nodes mainly</li>
          <li>Allocates pod subnet to each node</li>
          <li>Allocates join subnet IP to each node</li>
          <li>Allocates transit subnet IP to each node</li>
          <li>Consolidates zone statuses across all nodes for features like EgressFirewall and EgressQoS</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>The data plane includes the <code>ovnkube-node</code> and <code>ovs-node</code> pods in the <code>ovn-kubernetes</code> namespace</li>
  <li>ovnkube-node pod<ul>
      <li>ovnkube-controller container:<ul>
          <li>OVN-Kubernetes component</li>
          <li>Allocates podIP from the podSubnet to each pod in its zone (IPAM)</li>
          <li>Watches K8s API for objects - nodes, namespaces, pods, services, endpoints, network policies, CRs</li>
          <li>Translates K8s objects into OVN logical entities - stores them in OVN databases</li>
          <li>Stores OVN entities in NorthBound Database (NBDB)</li>
          <li>Manages pod subnet allocation to nodes (pod IPAM)</li>
          <li>Runs the CNI executable (CNI ADD/DEL)</li>
          <li>Digests the IPAM annotation set on pod</li>
          <li>Creates the veth pair for the pod</li>
          <li>Creates the ovs port on bridge</li>
          <li>Programs the necessary iptables and gateway service flows</li>
        </ul>
      </li>
      <li>nbdb container:<ul>
          <li>Native OVN component</li>
          <li>Runs the OVN NBDB database</li>
          <li>Stores the logical elements created by ovnkube-controller</li>
          <li>runs only 1 replica, contains information local to this node</li>
        </ul>
      </li>
      <li>northd container:<ul>
          <li>Native OVN component</li>
          <li>Converts the OVN logical elements from NBDB to OVN logical flows in SBDB</li>
        </ul>
      </li>
      <li>sbdb container:<ul>
          <li>Native OVN component</li>
          <li>Stores the logical flows created by northd</li>
          <li>runs only 1 replica, contains information local to this node</li>
        </ul>
      </li>
      <li>ovn-controller container:<ul>
          <li>Native OVN component</li>
          <li>Connects to SBDB running in control plane using TLS</li>
          <li>Converts SBDB logical flows into openflows</li>
          <li>Write them to OVS</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ovs-node pod<ul>
      <li>ovs-daemons container:<ul>
          <li>OVS Native component</li>
          <li>OVS daemon and database running as a container</li>
          <li>virtual switch that pushes the network plumbing to the edge on the node</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<h3>OVN-Kubernetes</h3>
<ul>
  <li>OVN supports distributed virtual routing, distributed logical switches, access control, Dynamic Host Configuration Protocol (DHCP), and DNS, which is not provided by basic openflow functionality.<ul>
      <li>For example, OVN-Kubernetes has built-in logic rules that recognize the types of request and handle it internally like pods sending requests to get ip address. The OVN recognize the request and acts as DHCP server and respond to the client pods.</li>
    </ul>
  </li>
  <li>OVN-Kubernetes runs a daemon on each node. There are daemon sets for the databases and for the OVN controller that run on every node. The OVN controller programs the Open vSwitch daemon on the nodes to support the following network provider features:<ul>
      <li>Egress IPs</li>
      <li>Firewalls</li>
      <li>Hardware offloading</li>
      <li>Hybrid networking</li>
      <li>Internet Protocol Security (IPsec) encryption</li>
      <li>IPv6</li>
      <li>Multicast.</li>
      <li>Network policy and network policy logs</li>
      <li>Routers</li>
    </ul>
  </li>
</ul>
<blockquote>
  <ul>
    <li><strong>Hardware offloading in OVN-Kubernetes</strong> means moving some networking work from the host CPU to the network interface card (NIC) hardware, so packet processing is faster and more efficient.'</li>
    <li><strong>Hybrid networking in OVN-Kubernetes</strong> is a mode that allows Kubernetes pods to communicate with <strong>external (non-Kubernetes) networks</strong> using the nodeâ€™s physical network (NATTING), while still using OVN for pod-to-pod networking inside the cluster.</li>
  </ul>
</blockquote>
<p>&nbsp;</p>
