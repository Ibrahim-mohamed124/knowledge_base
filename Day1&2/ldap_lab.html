<!--
title: ldap
description: 
published: true
date: 2025-12-05T17:46:25.346Z
tags: 
editor: ckeditor
dateCreated: 2025-12-05T17:44:55.146Z
-->

<h1>Integrating ldap</h1>
<ol>
  <li>obtain the following data from the ldap server:<ol>
      <li>bindPassword</li>
      <li>bindDN</li>
      <li>DNS name for the ldap host</li>
    </ol>
  </li>
</ol>
<blockquote>
  <p>The records in the ldap server must has uid &nbsp; because it is matched to the preferredUsername that is used to create the user and identity resources&nbsp;</p>
  <pre><code class="language-plaintext">ldapadd -x -w password -D "cn=admin,dc=example,dc=in" &lt;&lt; EOF


dn: cn=ahmed,ou=users,dc=example,dc=in
objectClass: inetOrgPerson
cn: ahmed
sn: ahmed
uid: ahmed  &gt;&gt; important
userPassword: 123
displayName: ahmed
EOF
adding new entry "cn=ahmed,ou=users,dc=example,dc=in"</code></pre>
  <p>&nbsp;</p>
</blockquote>
<p>&nbsp;2. put the base64 encoded password in a secret in openshift-config namespace</p>
<pre><code class="language-plaintext">oc create secret generic ldap-secret --from-literal=bindPassword=&lt;secret&gt; -n openshift-config</code></pre>
<pre><code class="language-plaintext">apiVersion: v1
kind: Secret
metadata:
  name: ldap-secret
  namespace: openshift-config
type: Opaque
data:
  bindPassword: &lt;base64_encoded_bind_password&gt;</code></pre>
<p>&nbsp;</p>
<blockquote>
  <p>it is possible to do ldap queries without authentication by leaving the bindDN empty “” in the oauth object. But anonymous query must be allowed first in the ldap server.</p>
  <pre><code class="language-plaintext">ldapmodify -H ldapi:/// -Y EXTERNAL &lt;&lt; EOF
dn: olcDatabase={1}mdb,cn=config
changetype: modify
add: olcAccess
olcAccess: {0}to * by anonymous read
EOF</code></pre>
  <p>&nbsp;</p>
</blockquote>
<p>3. create a configmap for the custom ca.crt</p>
<pre><code class="language-plaintext">oc create configmap ca-config-map --from-file=ca.crt=/path/to/ca -n openshift-config</code></pre>
<pre><code class="language-plaintext">apiVersion: v1
kind: ConfigMap
metadata:
  name: ca-config-map
  namespace: openshift-config
data:
  ca.crt: |
    &lt;CA_certificate_PEM&gt;</code></pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
